From fae4a5fae48fc47008e701a62a2d05f0b51d51eb Mon Sep 17 00:00:00 2001
From: Felix Fietkau <nbd@nbd.name>
Date: Fri, 23 Aug 2024 20:03:21 +0200
Subject: [PATCH 9006/9006] wifi: mt76: mt7915: extend calibration data merge
 support for 7981

Signed-off-by: Felix Fietkau <nbd@nbd.name>
---
 mt7915/eeprom.c | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/mt7915/eeprom.c b/mt7915/eeprom.c
index 9e93af17..d23fbe16 100644
--- a/mt7915/eeprom.c
+++ b/mt7915/eeprom.c
@@ -275,6 +275,7 @@ static int mt7915_apply_cal_free_data(struct mt7915_dev *dev)
 	enum adie_type {
 		ADIE_7975,
 		ADIE_7976,
+		ADIE_7981,
 	};
 	enum ddie_type {
 		DDIE_7915,
@@ -299,6 +300,13 @@ static int mt7915_apply_cal_free_data(struct mt7915_dev *dev)
 			       0x9b2, 0x9b3, 0x9b4, 0x9b5, 0x9b6, 0x9b7, -1},
 		[ADIE_7976] = {0x24c, 0x24d, 0x24e, 0x24f, 0x250, 0x251, 0x253, 0x255, 0x257,
 			       0x259, 0x990, 0x991, 0x994, 0x995, 0x9a6, 0x9a8, 0x9aa, -1},
+		[ADIE_7981] = {0x7cd, 0x7cf, 0x7d1, 0x7d3, 0x802, 0x803, 0x804, 0x805, 0x806,
+			       0x808, 0x80a, 0x80b, 0x80c, 0x80d, 0x80e, 0x810, 0x812, 0x813,
+			       0x814, 0x815, 0x816, 0x818, 0x81a, 0x81b, 0x81c, 0x81d, 0x81e,
+			       0x820, 0x822, 0x823, 0x824, 0x825, 0x826, 0x827, 0x828, 0x829,
+			       0x82f, 0x8c0, 0x8c1, 0x8c2, 0x8c3, 0x8d0, 0x8d1, 0x8d7, 0x8d8,
+			       0x8fa, 0x9a1, 0x9a5, 0x9a6, 0x9a8, 0x9aa, 0x9b0, 0x9b1, 0x9b2,
+			       0x9b3, 0x9b4, 0x9b5, 0x9b6, 0x9b7, -1 },
 	};
 	static const u16 eep_offs_list[][MT_EE_CAL_FREE_MAX_SIZE] = {
 		[ADIE_7975] = {0xe00, 0xe01, 0xe02, 0xe03, 0xe04, 0xe05, 0xe06, 0xe07, 0xe08,
@@ -332,8 +340,11 @@ static int mt7915_apply_cal_free_data(struct mt7915_dev *dev)
 		/* same as adie offset */
 		eep_offs[0] = NULL;
 		break;
-	case 0x7906:
 	case 0x7981:
+		adie_offs[0] = adie_offs_list[ADIE_7981];
+		eep_offs[0] = NULL;
+		break;
+	case 0x7906:
 		if (is_mt7916(&dev->mt76))
 			ddie_offs = ddie_offs_list[DDIE_7916];
 		adie_offs[0] = adie_offs_list[ADIE_7976];
-- 
2.43.5

